{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport _toConsumableArray from \"D:/vscode/projects/homework/lesson-5-homework/toutiao/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _regeneratorRuntime from \"D:/vscode/projects/homework/lesson-5-homework/toutiao/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"D:/vscode/projects/homework/lesson-5-homework/toutiao/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _JSXStyle from \"styled-jsx/style\";\nimport React, { useEffect, useState } from 'react';\nexport default function Main() {\n  var _useState = useState([]),\n      list = _useState[0],\n      setList = _useState[1];\n\n  useEffect(function () {\n    fetch(\"/api/news\").then( /*#__PURE__*/function () {\n      var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(res) {\n        var resp;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.next = 2;\n                return res.json();\n\n              case 2:\n                resp = _context.sent;\n                setList(resp.data);\n\n              case 4:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee);\n      }));\n\n      return function (_x) {\n        return _ref.apply(this, arguments);\n      };\n    }());\n  }, []);\n\n  function DateDiff(startTime) {\n    var date = new Date().valueOf() / 1000;\n    var timeDiff = date - startTime;\n\n    if (Math.floor(timeDiff / 86400 / 365) >= 1) {\n      return Math.floor(timeDiff / 86400 / 365) + \"年前\";\n    } else if (Math.floor(timeDiff / 86400 / 30) >= 1) {\n      return Math.floor(timeDiff / 86400 / 30) + \"月前\";\n    } else if (Math.floor(timeDiff / 86400) >= 1) {\n      return Math.floor(timeDiff / 86400) + \"天前\";\n    } else if (Math.floor(timeDiff / 3600) >= 1) {\n      return Math.floor(timeDiff / 3600) + \"小时前\";\n    } else if (Math.floor(timeDiff / 60) >= 1) {\n      return Math.floor(timeDiff / 60) + \"分钟前\";\n    } else {\n      return \"刚刚\";\n    }\n  } // const mainRef=useRef();\n  // console.log(mainRef.current)\n\n\n  var _useState2 = useState({}),\n      scrollPosition = _useState2[0],\n      setScrollPosition = _useState2[1];\n\n  useEffect(function () {\n    var handler = function handler() {\n      setScrollPosition({\n        scrollH: document.documentElement.scrollHeight,\n        clientH: document.documentElement.clientHeight,\n        scrollT: document.documentElement.scrollTop\n      });\n    };\n\n    window.addEventListener('scroll', handler, {\n      passive: true\n    });\n    return function () {\n      window.removeEventListener('scroll', handler);\n    };\n  }, []); // console.log(scrollPosition.scrollH-scrollPosition.clientH-scrollPosition.scrollT)\n\n  if (scrollPosition.scrollH - scrollPosition.clientH <= scrollPosition.scrollT + 400) {\n    fetch(\"/api/news\").then( /*#__PURE__*/function () {\n      var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(res) {\n        var resp;\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                _context2.next = 2;\n                return res.json();\n\n              case 2:\n                resp = _context2.sent;\n                setList(function (l) {\n                  return [].concat(_toConsumableArray(l), _toConsumableArray(resp.data));\n                });\n\n              case 4:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2);\n      }));\n\n      return function (_x2) {\n        return _ref2.apply(this, arguments);\n      };\n    }());\n  } // console.log(list)\n\n\n  return /*#__PURE__*/_jsxs(_Fragment, {\n    children: [/*#__PURE__*/_jsxs(\"div\", {\n      className: \"jsx-4146117004\" + \" \" + \"center-content\",\n      children: [/*#__PURE__*/_jsx(\"div\", {\n        className: \"jsx-4146117004\" + \" \" + \"msg\"\n      }), /*#__PURE__*/_jsx(\"div\", {\n        className: \"jsx-4146117004\" + \" \" + \"news-list\",\n        children: list.map(function (i) {\n          if (i.img_url === 'null') {\n            return /*#__PURE__*/_jsxs(\"div\", {\n              className: \"jsx-4146117004\" + \" \" + \"mode1\",\n              children: [/*#__PURE__*/_jsx(\"div\", {\n                className: \"jsx-4146117004\" + \" \" + \"news-title\",\n                children: /*#__PURE__*/_jsx(\"a\", {\n                  href: i.source_url,\n                  className: \"jsx-4146117004\" + \" \" + \"news-link\",\n                  children: i.title\n                })\n              }), /*#__PURE__*/_jsxs(\"div\", {\n                className: \"jsx-4146117004\" + \" \" + \"news-footer\",\n                children: [/*#__PURE__*/_jsxs(\"div\", {\n                  className: \"jsx-4146117004\" + \" \" + \"news-footer-left\",\n                  children: [/*#__PURE__*/_jsx(\"a\", {\n                    href: \"#!\",\n                    className: \"jsx-4146117004\" + \" \" + \"news-tag tag-politic\",\n                    children: i.tag\n                  }), /*#__PURE__*/_jsx(\"a\", {\n                    href: i.url,\n                    className: \"jsx-4146117004\" + \" \" + \"news-media-img\",\n                    children: /*#__PURE__*/_jsx(\"img\", {\n                      src: i.source_img,\n                      className: \"jsx-4146117004\"\n                    })\n                  }), /*#__PURE__*/_jsxs(\"a\", {\n                    href: i.url,\n                    className: \"jsx-4146117004\" + \" \" + \"news-about\",\n                    children: [\"\\xA0\", i.source, \"\\xA0\\xB7\"]\n                  }), /*#__PURE__*/_jsxs(\"a\", {\n                    href: \"#!\",\n                    className: \"jsx-4146117004\" + \" \" + \"news-about\",\n                    children: [\"\\xA0\", i.comments, \"\\u8BC4\\u8BBA\\xA0\\xB7\"]\n                  }), /*#__PURE__*/_jsxs(\"span\", {\n                    className: \"jsx-4146117004\" + \" \" + \"news-time\",\n                    children: [\"\\xA0\", DateDiff(i.time)]\n                  })]\n                }), /*#__PURE__*/_jsx(\"div\", {\n                  className: \"jsx-4146117004\" + \" \" + \"news-footer-right\",\n                  children: /*#__PURE__*/_jsx(\"div\", {\n                    className: \"jsx-4146117004\" + \" \" + \"dislike\",\n                    children: /*#__PURE__*/_jsx(\"span\", {\n                      className: \"jsx-4146117004\" + \" \" + \"close\",\n                      children: \"X\"\n                    })\n                  })\n                })]\n              })]\n            });\n          } else {\n            return /*#__PURE__*/_jsxs(\"div\", {\n              className: \"jsx-4146117004\" + \" \" + \"mode2\",\n              children: [/*#__PURE__*/_jsx(\"div\", {\n                className: \"jsx-4146117004\" + \" \" + \"mode2-left\",\n                children: /*#__PURE__*/_jsx(\"a\", {\n                  href: i.source_url,\n                  className: \"jsx-4146117004\" + \" \" + \"mode2-img\",\n                  children: /*#__PURE__*/_jsx(\"img\", {\n                    src: i.img_url,\n                    className: \"jsx-4146117004\"\n                  })\n                })\n              }), /*#__PURE__*/_jsx(\"div\", {\n                className: \"jsx-4146117004\" + \" \" + \"mode2-right\",\n                children: /*#__PURE__*/_jsxs(\"div\", {\n                  className: \"jsx-4146117004\" + \" \" + \"mode2-news\",\n                  children: [/*#__PURE__*/_jsx(\"div\", {\n                    className: \"jsx-4146117004\" + \" \" + \"news-title\",\n                    children: /*#__PURE__*/_jsx(\"a\", {\n                      href: i.source_url,\n                      className: \"jsx-4146117004\" + \" \" + \"news-link\",\n                      children: i.title\n                    })\n                  }), /*#__PURE__*/_jsxs(\"div\", {\n                    className: \"jsx-4146117004\" + \" \" + \"news-footer\",\n                    children: [/*#__PURE__*/_jsxs(\"div\", {\n                      className: \"jsx-4146117004\" + \" \" + \"news-footer-left\",\n                      children: [/*#__PURE__*/_jsx(\"a\", {\n                        href: \"#!\",\n                        className: \"jsx-4146117004\" + \" \" + \"news-tag tag-politic\",\n                        children: i.tag\n                      }), /*#__PURE__*/_jsx(\"a\", {\n                        href: i.url,\n                        className: \"jsx-4146117004\" + \" \" + \"news-media-img\",\n                        children: /*#__PURE__*/_jsx(\"img\", {\n                          src: i.source_img,\n                          className: \"jsx-4146117004\"\n                        })\n                      }), /*#__PURE__*/_jsxs(\"a\", {\n                        href: i.url,\n                        className: \"jsx-4146117004\" + \" \" + \"news-about\",\n                        children: [\"\\xA0\", i.source, \"\\xA0\\xB7\"]\n                      }), /*#__PURE__*/_jsxs(\"a\", {\n                        href: \"#!\",\n                        className: \"jsx-4146117004\" + \" \" + \"news-about\",\n                        children: [\"\\xA0\", i.comments, \"\\u8BC4\\u8BBA\\xA0\\xB7\"]\n                      }), /*#__PURE__*/_jsxs(\"span\", {\n                        className: \"jsx-4146117004\" + \" \" + \"news-time\",\n                        children: [\"\\xA0\", DateDiff(i.time)]\n                      })]\n                    }), /*#__PURE__*/_jsx(\"div\", {\n                      className: \"jsx-4146117004\" + \" \" + \"news-footer-right\",\n                      children: /*#__PURE__*/_jsx(\"div\", {\n                        className: \"jsx-4146117004\" + \" \" + \"dislike\",\n                        children: /*#__PURE__*/_jsx(\"span\", {\n                          className: \"jsx-4146117004\" + \" \" + \"close\",\n                          children: \"X\"\n                        })\n                      })\n                    })]\n                  })]\n                })\n              })]\n            });\n          }\n        })\n      })]\n    }), /*#__PURE__*/_jsx(_JSXStyle, {\n      id: \"4146117004\",\n      children: [\".center-content.jsx-4146117004{width:660px;display:inline-block;margin:0 auto;}\", \".mode1.jsx-4146117004{padding:10px 0;border-bottom:1px solid #e8e8e8;}\", \".news-title.jsx-4146117004{font-size:20px;margin-bottom:4px;line-height:1.3;font-weight:700;max-height:52px;overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:2;}\", \".news-link.jsx-4146117004{color:#222;}\", \".news-footer.jsx-4146117004{color:#999;margin-top:10px;height:20px;}\", \".news-footer-left.jsx-4146117004{display:inline-block;vertical-align:middle;line-height:20px;font-size:0;}\", \".news-footer-left.jsx-4146117004>*.jsx-4146117004{display:inline-block;vertical-align:middle;line-height:1;font-size:14px;}\", \".news-tag.jsx-4146117004{font-size:12px;margin-right:10px;padding:1px 2px;border:1px solid #87a5b5;color:#87a5b5;}\", \".tag-video.jsx-4146117004{border:1px solid #ff7920;color:#ff7920;}\", \".news-media-img.jsx-4146117004{width:18px;height:18px;margin-right:2px;border-radius:50%;overflow:hidden;}\", \".news-media-img.jsx-4146117004 img.jsx-4146117004{width:18px;height:18px;border-radius:50%;}\", \".news-about.jsx-4146117004{font-size:14px;color:#777;}\", \".news-time.jsx-4146117004{color:#777;}\", \".mode2.jsx-4146117004{height:102px;padding:10px 0;border-bottom:1px solid #e8e8e8;}\", \".mode2-left.jsx-4146117004{width:158px;height:102px;margin-right:16px;overflow:hidden;float:left;}\", \".mode2-img.jsx-4146117004{display:inline-block;position:relative;-webkit-transform-style:preserve-3d;-ms-transform-style:preserve-3d;transform-style:preserve-3d;}\", \".mode2-img.jsx-4146117004>img.jsx-4146117004{width:158px;height:102px;-webkit-transition:all 0.5s;transition:all 0.5s;}\", \".video-tip.jsx-4146117004{position:absolute;right:8px;bottom:8px;padding:0 6px 0 18px;background-color:rgba(0,0,0,0.7);border-radius:10px;font-size:12px;color:#fff;height:22px;line-height:22px;}\", \".video-tip.jsx-4146117004::before{content:\\\"\\\";position:absolute;top:7px;left:8px;border-style:solid;border-width:5px;border-color:transparent transparent transparent #fff;}\", \".mode2-right.jsx-4146117004{overflow:hidden;height:100%;position:relative;}\", \".mode2-news.jsx-4146117004{display:inline-block;width:100%;vertical-align:middle;position:absolute;top:50%;-webkit-transform:translateY(-50%);-ms-transform:translateY(-50%);transform:translateY(-50%);}\", \".news-footer-right.jsx-4146117004{float:right;}\", \".dislike.jsx-4146117004{height:20px;width:20px;}\", \".close.jsx-4146117004{font-size:12px;color:#ddd;}\"]\n    })]\n  });\n}","map":null,"metadata":{},"sourceType":"module"}